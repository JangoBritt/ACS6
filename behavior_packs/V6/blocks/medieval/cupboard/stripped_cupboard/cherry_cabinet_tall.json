{
	"format_version": "1.20.30",
	"minecraft:block": {
		"description": {
			"identifier": "medieval:cherry_cabinet_tall",
            "menu_category": {
                "category": "items",
                "group": "itemGroup.name.cherry",
                "is_hidden_in_commands": false
            },
			"states": {
				"medieval:facing_direction": [1,2,3,4,5],
				"medieval:side": [true,false],
				"medieval:close": [true,false],
				"medieval:item": [0,1,2]
			}
		},
		"permutations": [
			{"condition": "q.block_state('medieval:facing_direction') == 1","components": {"minecraft:geometry": "geometry.m.cabinet_tall_item"}},
			{"condition": "q.block_state('medieval:facing_direction') == 2","components": {"minecraft:transformation": { "rotation": [0,0,0]}}},
			{"condition": "q.block_state('medieval:facing_direction') == 3","components": {"minecraft:transformation": { "rotation": [0,180,0]},"tag:cabinet_south": {}}},
			{"condition": "q.block_state('medieval:facing_direction') == 4","components": {"minecraft:transformation": { "rotation": [0,90,0]},"tag:cabinet_east": {}}},
			{"condition": "q.block_state('medieval:facing_direction') == 5","components": {"minecraft:transformation": { "rotation": [0,-90,0]},"tag:cabinet_west": {}}},
			{"condition": "q.block_state('medieval:side')","components": {"tag:cabinet":{}}},
			{"condition": "!q.block_state('medieval:side')","components": {"tag:side": {}}},
			{"condition": "q.block_state('medieval:close')","components": {"tag:cabinet_close": {}}},
			{"condition": "q.block_state('medieval:item') == 1","components": {"minecraft:geometry": {
				"identifier": "geometry.m.cabinet_tall_book",
				"bone_visibility": {
					"close": "q.block_state('medieval:close') && q.block_state('medieval:side')",
					"open": "!q.block_state('medieval:close') && q.block_state('medieval:side')",
					"close2": "q.block_state('medieval:close') && !q.block_state('medieval:side')",
					"open2": "!q.block_state('medieval:close') && !q.block_state('medieval:side')"
				}
			}}},
			{"condition": "q.block_state('medieval:item') == 2","components": {"minecraft:geometry": {
				"identifier": "geometry.m.cabinet_tall_potion",
				"bone_visibility": {
					"close": "q.block_state('medieval:close') && q.block_state('medieval:side')",
					"open": "!q.block_state('medieval:close') && q.block_state('medieval:side')",
					"close2": "q.block_state('medieval:close') && !q.block_state('medieval:side')",
					"open2": "!q.block_state('medieval:close') && !q.block_state('medieval:side')"
				}
			}}}
		],
		"components": {
			"tag:medieval_furniture": {},
			"minecraft:geometry": {
				"identifier": "geometry.m.cabinet_tall_bot",
				"bone_visibility": {
					"close": "q.block_state('medieval:close') && q.block_state('medieval:side')",
					"open": "!q.block_state('medieval:close') && q.block_state('medieval:side')",
					"close2": "q.block_state('medieval:close') && !q.block_state('medieval:side')",
					"open2": "!q.block_state('medieval:close') && !q.block_state('medieval:side')"
				}
			},
			"minecraft:material_instances": {"planks": {"texture": "m.cherry_planks","render_method": "alpha_test"},"metal": {"texture": "light_gray_concrete","render_method": "alpha_test"},"*": {"texture": "m.stripped_cherry","render_method": "alpha_test"},"book": {"texture": "m.book_bookshelf","render_method": "alpha_test"},"potion": {"texture": "m.potion_bookshelf","render_method": "alpha_test"},"potion1": {"texture": "m.potion_bookshelf_1","render_method": "alpha_test"}},
			"tag:cherry":{},
			"minecraft:on_player_placing": {"event": "direction"},
			"minecraft:on_placed":{"event": "place_top"},
			"minecraft:on_interact": {"event": "open","target": "self"},
			"minecraft:queued_ticking": {"on_tick":{"event": "update"},"interval_range": [2,2],"looping": true},
			"minecraft:breathability": "air",
			"minecraft:light_dampening": 0.0,
			"minecraft:destructible_by_explosion": {"explosion_resistance": 3.0},
			"minecraft:destructible_by_mining": {"seconds_to_destroy": 0.8},
			"minecraft:map_color": "#fcd7f9"
		},
		"events": {
			"direction": {"set_block_state": {"medieval:facing_direction": "q.cardinal_facing_2d"}},
			"place_top": {
				"sequence": [
					{"condition": "(q.block_neighbor_has_any_tag(1,0,0,'cabinet') && q.block_state('medieval:facing_direction') == 3) || (q.block_neighbor_has_any_tag(-1,0,0,'cabinet') && q.block_state('medieval:facing_direction') == 2) || (q.block_neighbor_has_any_tag(0,0,1,'cabinet') && q.block_state('medieval:facing_direction') == 4) || (q.block_neighbor_has_any_tag(0,0,-1,'cabinet') && q.block_state('medieval:facing_direction') == 5) && !q.block_neighbor_has_any_tag(0,1,0,'medieval_furniture')","set_block_state": {"medieval:side": false}},
					{"run_command": {"command": ["setblock ~ ~1 ~ medieval:cherry_cabinet_tall_upper keep","execute positioned ~~0.5~ unless entity @e[type=medieval:big_container,r=0.5] run summon medieval:big_container ~~~ ~~ minecraft:entity_spawned cabinet_tall"]}}
				]
			},
			"update": {
				"sequence": [
					{"condition": "!(q.block_neighbor_has_any_tag(0,1,0,'cabinet'))","die": {"target": "self"}},
					{"condition": "q.block_neighbor_has_any_tag(0,1,0,'cabinet_top_close')","set_block_state": {"medieval:close": true}},
					{"condition": "q.block_neighbor_has_any_tag(0,1,0,'cabinet_top_open')","set_block_state": {"medieval:close": false}}
				]
			},
			"open": {
				"sequence": [
					{"condition": "q.block_state('medieval:close')","set_block_state":{"medieval:close": false},"run_command":{"command":["playsound block.barrel.open @a ~ ~ ~","setblock ~ ~1 ~ medieval:cherry_cabinet_tall_upper[\"medieval:close\"=false]"]}},
					{"condition": "!q.block_state('medieval:close') && ((!q.is_item_name_any('slot.weapon.mainhand',0,'minecraft:book','minecraft:potion') && q.block_state('medieval:item') == 0) || (q.block_state('medieval:item') > 0 && !q.is_sneaking))","set_block_state":{"medieval:close": true},"run_command":{"command":["playsound block.barrel.close @a ~ ~ ~","setblock ~ ~1 ~ medieval:cherry_cabinet_tall_upper[\"medieval:close\"=true]"]}},
					{"condition": "q.block_state('medieval:item') == 0 && q.is_item_name_any('slot.weapon.mainhand',0,'minecraft:book') && !q.block_state('medieval:close')","set_block_state":{"medieval:item": 1},"run_command":{"command":["playsound block.itemframe.add_item @a ~ ~ ~"]}},
					{"condition": "q.block_state('medieval:item') == 0 && q.is_item_name_any('slot.weapon.mainhand',0,'minecraft:potion') && !q.block_state('medieval:close')","set_block_state":{"medieval:item": 2},"run_command":{"command":["playsound block.itemframe.add_item @a ~ ~ ~"]}},
					{"condition": "q.is_sneaking && q.block_state('medieval:item') > 0 && !q.block_state('medieval:close')","set_block_state":{"medieval:item": 0},"run_command":{"command":["playsound block.itemframe.remove_item @a ~ ~ ~"]}}
				]
			}
		}
	}
}